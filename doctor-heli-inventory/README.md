# 🚁 ドクターヘリ物品管理システム

ドクターヘリの物品管理を効率化するためのウェブアプリケーションです。
PC・スマートフォンの両方から使用できます。

## 📋 主な機能

### 1. Excelファイルのアップロード
- `.xlsx`、`.xls`形式のExcelファイルに対応
- ドラッグ&ドロップまたはクリックでファイル選択
- 自動的にチェックリストを生成

### 2. チェックリスト管理
- 一覧表示で物品を確認
- チェックボックスで確認状態を管理
- 確認日時を自動記録

### 3. 担当者管理
- 各物品の確認者名を入力可能
- 確認履歴を記録

### 4. 使用期限管理
- 滅菌物の使用期限を入力・管理
- 期限切れ・期限間近の物品を視覚的に表示
- 7日以内に期限が切れる物品を警告表示

### 5. 統計情報
- 総物品数
- チェック済み/未チェック数
- 期限切れ間近の物品数

### 6. データ管理
- ブラウザのLocalStorageにデータを保存
- 日次チェックのクリア機能
- 全データのクリア機能

## 🚀 使い方

### 初回セットアップ

1. `index.html`をブラウザで開く
2. 「サンプルExcelをダウンロード」ボタンでサンプルファイルを取得
3. サンプルファイルを参考に、自施設の物品リストを作成

### Excelファイルの形式

| 物品名 | カテゴリ | 数量 | 備考 |
|--------|----------|------|------|
| 気管チューブ 7.0mm | 気道確保 | 5本 | 滅菌 |
| 静脈留置針 22G | 静脈路確保 | 10本 | 滅菌 |

**ポイント:**
- 1行目は項目名として扱われます
- 「備考」列に「滅菌」と記載すると、使用期限入力欄が表示されます

### 日常的な使用

1. **アプリを開く**
   - ブラウザで`index.html`を開く
   - スマートフォンからもアクセス可能

2. **物品をチェック**
   - チェックボックスをクリックして確認
   - 確認者名を入力
   - 滅菌物の場合は使用期限を入力

3. **保存**
   - 自動保存されますが、「保存」ボタンで明示的に保存可能

4. **翌日のリセット**
   - 「日次チェックをクリア」ボタンで全チェックをリセット

### 定期的な更新

1. Excelファイルで物品リストを更新
2. 更新したファイルをアップロード
3. チェックリストが自動的に更新されます

## 💻 技術仕様

- **フロントエンド**: HTML5 + CSS3 + JavaScript (ES6+)
- **Excelライブラリ**: SheetJS (xlsx)
- **データ保存**: LocalStorage
- **レスポンシブデザイン**: モバイル対応

## 📱 対応ブラウザ

- Google Chrome (推奨)
- Mozilla Firefox
- Safari
- Microsoft Edge

## 🔧 カスタマイズ

### 期限警告日数の変更

`index.html`内の以下の部分を編集:

```javascript
// 7日前に警告 → 14日前に変更する場合
const sevenDaysLater = new Date(now.getTime() + 14 * 24 * 60 * 60 * 1000);
```

### 色やデザインの変更

`<style>`タグ内のCSSを編集してカスタマイズできます。

## 📝 今後の改善予定（アジャイル開発）

- [ ] サーバー連携でデータの共有
- [ ] PDFエクスポート機能
- [ ] 物品の追加・編集・削除機能
- [ ] 履歴管理機能
- [ ] QRコード対応
- [ ] プッシュ通知（期限切れアラート）
- [ ] 多言語対応
- [ ] オフライン対応（PWA化）

## 🐛 トラブルシューティング

### データが消えてしまった
- ブラウザのキャッシュをクリアするとデータが消えます
- 定期的にExcelファイルをバックアップしてください

### Excelファイルが読み込めない
- ファイル形式が`.xlsx`または`.xls`であることを確認
- ファイルが破損していないか確認
- サンプルファイルで動作確認

### スマートフォンで表示が崩れる
- 最新のブラウザを使用してください
- 画面を横向きにすると見やすくなります

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 👤 作成者

個人学習用プロジェクト

## 🙏 謝辞

- SheetJS ライブラリの開発者の皆様
- オープンソースコミュニティ

---

**注意**: このアプリケーションは試作品です。実際の医療現場で使用する場合は、
適切なテストと検証を行ってください。
