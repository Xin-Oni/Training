# ドクターヘリ物品チェックリストアプリ

ドクターヘリに搭載されている医療物品を管理・チェックするための iOS アプリケーションです。
Google Sheets と連携し、複数のデバイスでリアルタイムにデータを同期できます。

## 主な機能

### ✅ チェックリスト機能
- 物品の一覧表示とチェック状態の管理
- カテゴリ別フィルター（医薬品、医療機器、消耗品、緊急用品、その他）
- 検索機能による物品の素早い検索

### 📅 使用期限管理
- 使用期限の登録と表示
- 期限切れアラート（赤色表示）
- 期限間近アラート（30日以内、オレンジ色表示）
- 日付ピッカーによる簡単な日付入力

### 📊 Google Sheets 連携
- スプレッドシートとのリアルタイム同期
- アプリでチェックすると自動的にスプレッドシートも更新
- オフライン時はローカルに保存、オンライン復帰時に同期

### 📝 詳細情報管理
- 物品名、カテゴリ、数量
- 保管場所
- 備考（メモ）
- 最終チェック日時の自動記録

## セットアップ方法

### 1. Xcode でプロジェクトを開く

```bash
# プロジェクトディレクトリに移動
cd DoctorHeliChecklistApp

# Xcode でプロジェクトを開く（.xcodeproj ファイルを作成後）
open DoctorHeliChecklistApp.xcodeproj
```

### 2. Google Sheets の準備

#### 2.1 スプレッドシートを作成

1. [Google Sheets](https://sheets.google.com) にアクセス
2. 新しいスプレッドシートを作成
3. 以下の形式でヘッダー行（1行目）を作成：

| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 |
|-----|-----|-----|-----|-----|-----|-----|-----|
| 物品名 | カテゴリ | チェック状態 | 使用期限 | 数量 | 保管場所 | 備考 | 最終チェック日時 |

4. サンプルデータを入力（`Resources/SpreadsheetTemplate.csv` を参照）

#### 2.2 スプレッドシートを共有設定

1. スプレッドシートの「共有」ボタンをクリック
2. 「制限付き」から「リンクを知っている全員」に変更
3. 権限を「閲覧者」または「編集者」に設定
4. URLをコピー（例：`https://docs.google.com/spreadsheets/d/1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms/edit`）
5. URLから**スプレッドシートID**を抜き出す（`1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms` の部分）

#### 2.3 Google Cloud Console で API キーを取得

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. 新しいプロジェクトを作成（または既存のプロジェクトを選択）
3. 「APIとサービス」→「ライブラリ」に移動
4. 「Google Sheets API」を検索して有効化
5. 「APIとサービス」→「認証情報」に移動
6. 「認証情報を作成」→「APIキー」を選択
7. 作成された API キーをコピー
8. （推奨）APIキーの制限を設定：
   - アプリケーションの制限：iOS アプリ
   - API の制限：Google Sheets API

### 3. アプリの設定

1. アプリを起動
2. 右上の⚙️（歯車アイコン）をタップして設定画面を開く
3. **スプレッドシートID** を入力
4. **API キー**を入力
5. 「保存」をタップ

### 4. 動作確認

1. メイン画面に戻る
2. 右上の🔄（更新アイコン）をタップして同期
3. スプレッドシートのデータが表示されることを確認
4. アイテムをチェックして、スプレッドシートに反映されることを確認

## 使い方

### 物品のチェック

- リスト上の○アイコンをタップするとチェック状態に変わります
- チェックすると自動的に最終チェック日時が記録されます
- Google Sheets と連携している場合、自動的に同期されます

### 物品の詳細表示・編集

- リストのアイテムをタップすると詳細画面が開きます
- 物品名、カテゴリ、数量、保管場所を編集できます
- 使用期限の設定・変更が可能です
- 備考欄にメモを追加できます

### 新しい物品の追加

- 右上の＋アイコンをタップ
- 必要な情報を入力
- 「追加」をタップ

### カテゴリでフィルター

- 画面上部のカテゴリボタンをタップすると、そのカテゴリの物品のみが表示されます
- 「すべて」を選択すると全ての物品が表示されます

### 検索

- 画面上部の検索バーに物品名を入力すると、該当する物品のみが表示されます

## プロジェクト構造

```
DoctorHeliChecklistApp/
├── DoctorHeliChecklistApp.swift  # アプリのエントリーポイント
├── Models/
│   ├── SupplyItem.swift          # 物品データモデル
│   └── ChecklistViewModel.swift  # ビジネスロジック
├── Views/
│   ├── ContentView.swift         # メイン画面
│   ├── ItemDetailView.swift      # 物品詳細画面
│   ├── AddItemView.swift         # 物品追加画面
│   └── SettingsView.swift        # 設定画面
├── Services/
│   └── GoogleSheetsService.swift # Google Sheets API 連携
└── Resources/
    ├── Info.plist                # アプリ設定
    └── SpreadsheetTemplate.csv   # スプレッドシートテンプレート
```

## 技術スタック

- **言語**: Swift 5.5+
- **フレームワーク**: SwiftUI
- **最小 iOS バージョン**: iOS 15.0
- **API**: Google Sheets API v4
- **データ保存**: UserDefaults（ローカルストレージ）

## 注意事項

### セキュリティ

- API キーは適切に管理してください
- 本番環境では、OAuth 2.0 による認証の使用を推奨します
- スプレッドシートの共有設定に注意してください

### オフライン動作

- インターネット接続がない場合、ローカルに保存されたデータを使用します
- オフラインで行った変更は、次回の同期時にスプレッドシートに反映されます
- ただし、複数デバイスでの同時編集には注意が必要です（競合の可能性）

### データ形式

- 日付は `yyyy/MM/dd` 形式で入力してください
- チェック状態は `✓` または `true` で表現されます
- 空白の使用期限は「期限なし」として扱われます

## トラブルシューティング

### スプレッドシートに接続できない

1. スプレッドシートIDが正しいか確認
2. API キーが正しいか確認
3. スプレッドシートの共有設定を確認
4. Google Sheets API が有効化されているか確認

### データが同期されない

1. インターネット接続を確認
2. 更新ボタンをタップして手動同期を試す
3. アプリを再起動
4. スプレッドシートの形式が正しいか確認

### 使用期限が正しく表示されない

- スプレッドシートの日付形式が `yyyy/MM/dd` であることを確認
- 例：`2025/12/31`

## ライセンス

このプロジェクトは教育・訓練目的で作成されています。

## お問い合わせ

問題や質問がある場合は、プロジェクトの Issue を作成してください。

## 今後の改善案

- [ ] OAuth 2.0 による安全な認証
- [ ] プッシュ通知（期限切れアラート）
- [ ] QRコード読み取り機能
- [ ] データのエクスポート機能（PDF、Excel）
- [ ] 複数のスプレッドシート管理
- [ ] ダークモード対応
- [ ] Apple Watch 対応
- [ ] バーコードスキャン機能
- [ ] チーム間での同期改善
